[tool.ruff]
# ========== 基础配置 ==========
line-length = 88  # 代码行最大长度（与 Black 格式化工具保持一致）
exclude = [
    ".git",        # Git 版本控制目录
    "__pycache__", # Python 字节码缓存目录
    "venv",        # 虚拟环境目录
    "logs",        # 日志目录
    ".vscode",     # vscode配置目录
    "docs",        # 文档目录
    "migrations",  # 数据库迁移文件目录
    "*.egg-info",  # Python 包信息目录
]

# ========== 目标 Python 版本 ==========
target-version = "py312"  # 项目目标 Python 版本（根据实际情况调整）

[tool.ruff.lint]
# ========== 规则选择 ==========
# 启用常用规则集：
# E - pycodestyle 错误（代码风格问题）
# W - pycodestyle 警告（代码风格警告）
# F - pyflakes（未使用变量、导入等）
# I - isort（导入排序）
# N - pep8-naming（命名规范）
# UP - pyupgrade（Python 版本升级建议）
# B - flake8-bugbear（常见 bug 模式）
# C4 - flake8-comprehensions（推导式优化）
# TCH - flake8-type-checking（类型检查相关）
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "N",   # pep8-naming
    "UP",  # pyupgrade
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "TCH", # flake8-type-checking
]

# ========== 忽略特定规则 ==========
ignore = [
    "E501",    # 行过长（由格式化工具处理）
    "B008",    # 不要在函数参数中执行函数调用（常见于 FastAPI 依赖注入）
    "N805",    # 第一个参数不应该命名为 cls（对于类方法）
    "N806",    # 函数中的变量不应该大写（常见于 API 响应）
    "TC001",  # 允许在类型注解中导入但不使用
    "TC002",  # 允许在类型注解中导入但不使用
    "TC003",  # 允许在类型注解中导入但不使用
]

# ========== 自动修复配置 ==========
fixable = ["ALL"]  # 自动修复所有可修复的问题

# ========== 导入排序配置 ==========
[tool.ruff.lint.isort]
known-first-party = ["Modules", "config"]  # 项目第一方包
known-third-party = ["fastapi", "sqlmodel"]  # 常见第三方包
section-order = ["future", "standard-library", "third-party", "first-party", "local-folder"]

# ========== 格式化配置 ==========
[tool.ruff.format]
quote-style = "double"      # 使用双引号
indent-style = "space"      # 使用空格缩进
skip-magic-trailing-comma = false  # 保留尾随逗号
line-ending = "auto"        # 自动检测行结束符